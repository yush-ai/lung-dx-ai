# 📋 如何查看 AI 诊断结果

## 🎯 四种查看方式

### 方式 1️⃣: 在终端查看（最直接）

**步骤：**

1. 保持 `npm run dev` 运行
2. 在浏览器中上传图片并点击"开始 AI 分析"
3. 回到运行 `npm run dev` 的终端窗口
4. 你会看到如下输出：

```
POST /api/analyze 200 in 12333ms

========== AI 诊断结果 ==========
【这里是 AI 返回的完整诊断文本】

根据提供的肺部CT影像分析：

1. 肺结节发现情况：
   影像中发现多个肺部结节，位于不同肺叶...

2. 结节特征描述：
   - 右上叶结节：大小约12mm，边界清晰...
   - 左下叶结节：大小约8mm，呈半实性...

3. 恶性风险评估：
   综合评估为高风险，建议...

4. 诊疗建议：
   建议立即进行进一步检查...
================================

Token 使用情况:
- 提示词:  1234
- 生成:  567
- 总计:  1801
```

**优点**: 
- ✅ 最原始的文本
- ✅ 包含 Token 使用统计
- ✅ 不需要额外操作

---

### 方式 2️⃣: 在浏览器控制台查看（最漂亮）

**步骤：**

1. 打开浏览器（Chrome/Edge/Firefox）
2. 按 `F12` 打开开发者工具
3. 点击 `Console`（控制台）标签
4. 上传图片并点击"开始 AI 分析"
5. 在控制台看到带颜色的输出：

![控制台示例](示例图)

**优点**: 
- ✅ 彩色格式化显示
- ✅ 可以复制文本
- ✅ 有 Token 统计

**控制台输出示例：**
```
========== AI 诊断结果 ==========  (蓝色粗体)
【AI 诊断文本，深灰色，易读】
================================  (蓝色粗体)

Token 使用情况:  (绿色粗体)
提示词: 1234 | 生成: 567 | 总计: 1801
```

---

### 方式 3️⃣: 在详情页面查看（最友好）

**步骤：**

1. 完成 AI 分析后自动跳转到详情页
2. 在页面右侧找到"诊断建议"卡片
3. 查看 AI 生成的诊断文本
4. 点击"📋 复制建议"按钮可复制文本

**优点**: 
- ✅ 用户友好的界面
- ✅ 带格式显示
- ✅ 一键复制功能
- ✅ 无需技术知识

---

### 方式 4️⃣: 使用浏览器 Storage 查看

**步骤：**

1. 在浏览器控制台（F12 → Console）输入：
   ```javascript
   sessionStorage.getItem('aiDiagnosis')
   ```
2. 按回车查看最后一次诊断结果

**或者查看所有存储的数据：**
```javascript
// 查看诊断文本
console.log(sessionStorage.getItem('aiDiagnosis'))

// 查看上传的文件信息
console.log(sessionStorage.getItem('uploadedFiles'))
```

**优点**: 
- ✅ 随时查看历史结果
- ✅ 不需要重新分析
- ✅ 可编程访问

---

## 🎬 完整演示流程

### 1. 启动项目
```bash
npm run dev
```

### 2. 打开两个窗口
- **窗口 A**: 运行 `npm run dev` 的终端
- **窗口 B**: 浏览器（http://localhost:3001）

### 3. 在浏览器中操作
1. 打开 http://localhost:3001
2. 按 F12 打开控制台
3. 拖拽或选择肺部影像文件
4. 点击"开始 AI 分析"
5. 观察按钮变为"AI 分析中..."

### 4. 同时观察两个地方
- **终端窗口**: 实时显示 API 调用和诊断结果
- **浏览器控制台**: 显示带颜色的格式化结果

### 5. 查看最终结果
- 自动跳转到详情页
- 在"诊断建议"区域查看格式化的诊断

---

## 📸 截图示例

### 终端输出示例：
```
 ○ Compiling /api/analyze ...
 ✓ Compiled /api/analyze in 240ms (309 modules)
 POST /api/analyze 200 in 12333ms

========== AI 诊断结果 ==========
根据提供的肺部影像分析：

【详细的诊断文本】
...
================================

Token 使用情况:
- 提示词:  1234
- 生成:  567  
- 总计:  1801
```

### 浏览器控制台示例：
```
========== AI 诊断结果 ==========  ← 蓝色粗体
【AI 诊断内容】                    ← 深灰色文本
================================  ← 蓝色粗体

Token 使用情况:                    ← 绿色粗体
提示词: 1234 | 生成: 567 | 总计: 1801
```

---

## 🔍 详细分析 AI 输出

### AI 通常会返回这些内容：

1. **结节发现情况**
   - 是否发现结节
   - 结节数量

2. **结节特征描述**
   - 大小（如：12mm）
   - 位置（如：右上叶）
   - 形态（实性/半实性/非实性）

3. **风险评估**
   - 恶性风险等级：低/中/高
   - 置信度评估

4. **诊疗建议**
   - 是否需要进一步检查
   - 建议的检查类型（如 PET-CT、活检）
   - 随访建议

### 示例诊断文本：
```
根据提供的肺部CT影像分析：

1. 肺结节发现情况：
   影像中发现3个肺部结节，分布于不同肺叶。

2. 结节特征描述：
   
   结节1（右上叶）：
   - 大小：约12mm
   - 形态：实性结节，边界清晰
   - 密度：高密度，约+40HU
   
   结节2（左下叶）：
   - 大小：约8mm
   - 形态：半实性结节
   - 特点：有毛刺征
   
   结节3（右中叶）：
   - 大小：约5mm
   - 形态：非实性结节
   - 特点：磨玻璃样改变

3. 恶性风险评估：
   
   结节1：高风险（70%恶性可能）
   - 大小超过10mm
   - 实性成分为主
   - 边缘不规则
   
   结节2：中等风险（55%恶性可能）
   - 半实性特征
   - 有毛刺征
   
   结节3：低风险（20%恶性可能）
   - 小于6mm
   - 纯磨玻璃样
   
4. 诊疗建议：
   
   综合风险评分：高
   
   建议措施：
   - 立即安排进一步检查
   - 建议PET-CT扫描评估代谢活性
   - 考虑穿刺活检明确病理
   - 建议胸外科会诊
   
   随访建议：
   - 3个月后复查CT
   - 密切观察结节变化
   - 如有症状加重立即就诊
```

---

## 💡 实用技巧

### 技巧 1: 对比多次分析结果
```javascript
// 在浏览器控制台
// 第一次分析后保存
const diagnosis1 = sessionStorage.getItem('aiDiagnosis');

// 第二次分析后对比
const diagnosis2 = sessionStorage.getItem('aiDiagnosis');
console.log('第一次:', diagnosis1);
console.log('第二次:', diagnosis2);
```

### 技巧 2: 导出诊断文本
```javascript
// 在浏览器控制台
const diagnosis = sessionStorage.getItem('aiDiagnosis');
const blob = new Blob([diagnosis], { type: 'text/plain' });
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = 'AI诊断结果.txt';
a.click();
```

### 技巧 3: 格式化显示
```javascript
// 在浏览器控制台
const diagnosis = sessionStorage.getItem('aiDiagnosis');
console.log('%c' + diagnosis, 'font-size: 14px; line-height: 1.8; color: #2d3748;');
```

---

## ⚠️ 注意事项

### 数据存储
- 诊断结果存储在 `sessionStorage` 中
- 关闭浏览器窗口后会自动清除
- 刷新页面数据仍然保留

### Token 使用
- 每次分析消耗 API Token
- 在控制台可以看到消耗数量
- 注意 API 配额限制

### 最佳实践
- ✅ 保存重要的诊断结果
- ✅ 定期备份重要数据
- ✅ 不要完全依赖缓存数据

---

## 🆘 常见问题

### Q: 为什么看不到诊断结果？
A: 
1. 检查终端是否有错误信息
2. 确认 API Key 配置正确
3. 查看浏览器控制台的错误

### Q: 诊断文本在哪里存储？
A: 
- 临时存储：`sessionStorage.aiDiagnosis`
- 关闭浏览器后自动清除

### Q: 可以导出诊断报告吗？
A: 
- 方式 1: 点击"复制建议"按钮
- 方式 2: 使用上面的导出技巧
- 方式 3: 直接复制终端输出

### Q: 如何调试 AI 输出？
A: 
1. 查看终端完整输出
2. 检查浏览器控制台
3. 查看网络请求响应

---

## 📚 相关文档

- [AI 配置指南](./AI_SETUP.md)
- [快速开始](./QUICK_START.md)
- [完整文档](./README.md)

---

**现在就试试吧！** 🚀

